This YAML models a Signed Binary Proxy Execution technique using control.exe and a .cpl (Control Panel) file: an adversary places or supplies a malicious Control Panel applet (CPL) and uses the legitimate, signed control.exe to load and execute it, which in this test launches calc.exe as a visible proof-of-concept. In practice the attacker’s CPL can contain arbitrary code or shell execution logic (or drop and run other payloads) that runs in the context of a trusted Windows binary, allowing execution while blending into normal system activity; the script verifies the CPL exists, starts control.exe with the CPL path, waits briefly, then checks for the spawned process and reports success or exits with specific error codes on failure. Adversaries abuse this pattern to bypass application control and allowlisting defenses (because control.exe is a signed Microsoft binary), evade simple file-based detection, and achieve initial execution, privilege escalation, or persistence (CPLs can be dropped to locations that Windows will load or used in social-engineering lures). From a detection perspective, this technique produces telltale artifacts—control.exe launched with unusual arguments, unexpected CPL files in nonstandard locations, and new child processes spawned by control.exe—so defenders should monitor process creation events, uncommon CPL file writes, and anomalous use of signed system binaries to spot misuse.
